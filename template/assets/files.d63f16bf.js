import{a as B,k as T,m as q,i as N,n as Y,o as I,p as L,q as M,r as U,s as k,t as j}from"./_element-plus.3a35db37.js";import{_ as F,g as H,s as u,a as p}from"./index.1930e512.js";import{p as R}from"./__vendor.467a6c12.js";import{f as z,r as V,e as X,a4 as x,o as E,c as Z,a as b,_ as e,T as t,S as A,X as G,Y as i,Z as w}from"./_@vue.73c7d285.js";import"./_@element-plus.8770ec28.js";const J={name:"filelist",setup(){const _=z(""),s=z([]),c=V({order:"",desc:"",start:0,limit:1e3,ctime:0,mtime:0}),l=V({data:[]}),h=()=>{u({url:p.getList,method:"get",params:c}).then(a=>{console.log(a.data),l.data=a.data.data.list})};h();const y=()=>{c.start=0,h()},f=X(()=>l.data.filter(a=>!_.value||a.server_filename.toLowerCase().includes(_.value.toLowerCase())));return{getfilesize:H,load:(a,r,n)=>{u({url:p.getList,method:"get",params:{dir:a.path,limit:c.limit}}).then(v=>{n(v.data.data.list)})},dayjs:R,query:c,search:_,filterTableData:f,handleDelete:()=>{j.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{let a=[];for(const r in s.value)a.push(s.value[r].path);u({url:p.delFiles,method:"post",data:{files:a}}).then(r=>{k.success("\u5220\u9664\u6210\u529F");for(var n=l.data.length-1;n!=-1;n--)a.includes(l.data[n].path)&&l.data.splice(n,1)})})},handleSearch:y,handleDownload:()=>{let a=[];for(const r in s.value)a.push(s.value[r].fs_id);u({url:p.getFiles,method:"post",data:{fsids:a}}).then(r=>{k.success("\u4EFB\u52A1\u5F00\u59CB\u4E0B\u8F7D")})},handleDetail:(a,r)=>{console.log(a,r)},handleSelectionChange:a=>{s.value=a}}}},K={class:"crumbs"},O=i(" \u5168\u90E8\u6587\u4EF6 "),P={class:"container"},Q={class:"handle-box"},W=i("\u4E0B\u8F7D "),$=i("\u5220\u9664 "),ee=i("\u641C\u7D22");function ae(_,s,c,l,h,y){const f=x("files",!0),g=B,C=T,D=q,m=N,d=Y,a=I,r=L,n=M,v=x("folder"),S=U;return E(),Z("div",null,[b("div",K,[e(D,{separator:"/"},{default:t(()=>[e(C,null,{default:t(()=>[e(g,null,{default:t(()=>[e(f)]),_:1}),O]),_:1})]),_:1})]),b("div",P,[b("div",Q,[e(r,{gutter:10},{default:t(()=>[e(d,{span:2},{default:t(()=>[e(m,{size:"small",type:"success",icon:"Download",onClick:l.handleDownload,style:{width:"100%"}},{default:t(()=>[W]),_:1},8,["onClick"])]),_:1}),e(d,{span:2},{default:t(()=>[e(m,{size:"small",type:"danger",icon:"Delete",onClick:l.handleDelete,style:{width:"100%"}},{default:t(()=>[$]),_:1},8,["onClick"])]),_:1}),e(d,{span:6},{default:t(()=>[e(a,{modelValue:l.search,"onUpdate:modelValue":s[0]||(s[0]=o=>l.search=o),size:"small",placeholder:"\u7B5B\u9009\u6587\u4EF6\u540D"},null,8,["modelValue"])]),_:1}),e(d,{span:5},{default:t(()=>[e(a,{size:"small",modelValue:l.query.start,"onUpdate:modelValue":s[1]||(s[1]=o=>l.query.start=o),placeholder:"\u8D77\u59CB\u7F16\u53F7"},null,8,["modelValue"])]),_:1}),e(d,{span:5},{default:t(()=>[e(a,{size:"small",modelValue:l.query.limit,"onUpdate:modelValue":s[2]||(s[2]=o=>l.query.limit=o),placeholder:"\u6BCF\u9875\u663E\u793A"},null,8,["modelValue"])]),_:1}),e(d,{span:3},{default:t(()=>[e(m,{size:"small",type:"primary",icon:"Search",onClick:l.handleSearch},{default:t(()=>[ee]),_:1},8,["onClick"])]),_:1})]),_:1})]),e(S,{data:l.filterTableData,height:"800",stripe:"",size:"small","highlight-current-row":"",class:"table",ref:"multipleTable","default-sort":{prop:"server_mtime",order:"descending"},"header-cell-class-name":"table-header",lazy:"","row-key":"fs_id",load:l.load,"tree-props":{hasChildren:"isdir"},onSelectionChange:l.handleSelectionChange},{default:t(()=>[e(n,{type:"selection",width:"55"}),e(n,{"min-width":"300px",label:"\u6587\u4EF6\u540D",prop:"server_filename",sortable:""},{default:t(o=>[o.row.isdir?(E(),A(g,{key:0},{default:t(()=>[e(v)]),_:1})):G("",!0),i(" "+w(o.row.server_filename),1)]),_:1}),e(n,{width:"100px",label:"\u5927\u5C0F",prop:"size",sortable:""},{default:t(o=>[i(w(o.row.size>0?l.getfilesize(o.row.size):"\u6587\u4EF6\u5939"),1)]),_:1}),e(n,{"min-width":"150px",label:"\u4FEE\u6539\u65E5\u671F",prop:"server_mtime",sortable:""},{default:t(o=>[i(w(l.dayjs.unix(o.row.server_mtime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1},8,["data","load","onSelectionChange"])])])}var re=F(J,[["render",ae],["__scopeId","data-v-12024ca6"]]);export{re as default};
